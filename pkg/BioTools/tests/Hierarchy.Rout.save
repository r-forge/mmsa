
R version 3.0.2 (2013-09-25) -- "Frisbee Sailing"
Copyright (C) 2013 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(BioTools)
Loading required package: Biostrings
Loading required package: BiocGenerics
Loading required package: parallel

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:parallel’:

    clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
    clusterExport, clusterMap, parApply, parCapply, parLapply,
    parLapplyLB, parRapply, parSapply, parSapplyLB

The following object is masked from ‘package:stats’:

    xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, as.data.frame, cbind, colnames, duplicated, eval,
    Filter, Find, get, intersect, lapply, Map, mapply, match, mget,
    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
    rbind, Reduce, rep.int, rownames, sapply, setdiff, sort, table,
    tapply, union, unique, unlist

Loading required package: IRanges
Loading required package: DBI
Loading required package: RSQLite
Loading required package: seqLogo
Loading required package: grid
Loading required package: proxy

Attaching package: ‘proxy’

The following objects are masked from ‘package:stats’:

    as.dist, dist

Loading required package: ape

Attaching package: ‘BioTools’

The following object is masked from ‘package:ape’:

    clustal

> 
> db <- openGenDB(system.file("examples/16S.sqlite",package="BioTools"))
> 
> getTaxonomyNames(db)
 [1] "Kingdom"  "Phylum"   "Class"    "Order"    "Family"   "Genus"   
 [7] "Species"  "Otu"      "Org_name" "Id"      
> 
> getRank(db, rank="genus")
 [1] "Coprothermobacter"     "Desulfotomaculum"      "Pelotomaculum"        
 [4] "Syntrophomonas"        "unknown"               "Moorella"             
 [7] "Thermacetogenium"      "Thermaerobacter"       "Carboxydothermus"     
[10] "Thermoanaerobacterium" "Thermoanaerobacter"    "Selenomonas"          
[13] "Mitsuokella"           "Veillonella"           "Dialister"            
[16] "Desulfosporomusa"      "Thermosinus"           "Acidaminococcus"      
[19] "Phascolarctobacterium"
> getRank(db, rank="genus", count=TRUE)
     Desulfotomaculum               unknown    Thermoanaerobacter 
                   20                    12                    10 
          Selenomonas Thermoanaerobacterium      Desulfosporomusa 
                    9                     8                     7 
       Syntrophomonas           Veillonella              Moorella 
                    6                     5                     4 
        Pelotomaculum             Dialister       Acidaminococcus 
                    4                     3                     2 
     Carboxydothermus Phascolarctobacterium           Thermosinus 
                    2                     2                     2 
    Coprothermobacter           Mitsuokella      Thermacetogenium 
                    1                     1                     1 
      Thermaerobacter 
                    1 
> getRank(db, rank="species", whereRank="genus", whereName="Desulfotomaculum")
[1] "unknown"                          "Desulfotomaculum geothermicum"   
[3] "Desulfotomaculum thermobenzoicum" "Desulfotomaculum acetoxidans"    
[5] "Desulfotomaculum gibsoniae"      
> getRank(db, rank="species", whereRank="genus", whereName="D")
character(0)
Warning message:
In getRank(db, rank = "species", whereRank = "genus", whereName = "D") :
  No matching name in rank found!
> getRank(db, rank="species", whereRank="genus", 
+ 	whereName=c("Desulfotomaculum", "Syntrophomonas"))
[1] "unknown"                          "Desulfotomaculum geothermicum"   
[3] "Desulfotomaculum thermobenzoicum" "Desulfotomaculum acetoxidans"    
[5] "Desulfotomaculum gibsoniae"       "Syntrophomonas wolfei"           
> getRank(db, rank="species", whereRank="genus", 
+ 	whereName=c("De", "Sy"))
character(0)
Warning messages:
1: In getRank(db, rank = rank, whereRank = rank, whereName = n) :
  No matching name in rank found!
2: In getRank(db, rank = rank, whereRank = rank, whereName = n) :
  No matching name in rank found!
3: In getRank(db, rank = "species", whereRank = "genus", whereName = c("De",  :
  No matching name in rank found!
> getRank(db, rank="species", whereRank="genus", whereName="Desulfotomaculum",
+ 	all=TRUE)
 [1] unknown                          Desulfotomaculum geothermicum   
 [3] unknown                          Desulfotomaculum thermobenzoicum
 [5] unknown                          unknown                         
 [7] unknown                          Desulfotomaculum thermobenzoicum
 [9] unknown                          unknown                         
[11] unknown                          unknown                         
[13] unknown                          Desulfotomaculum thermobenzoicum
[15] Desulfotomaculum thermobenzoicum Desulfotomaculum acetoxidans    
[17] Desulfotomaculum acetoxidans     Desulfotomaculum acetoxidans    
[19] unknown                          Desulfotomaculum gibsoniae      
5 Levels: Desulfotomaculum acetoxidans ... unknown
> getRank(db, rank="species", whereRank="genus", whereName="Doesnotexist")
character(0)
Warning message:
In getRank(db, rank = "species", whereRank = "genus", whereName = "Doesnotexist") :
  No matching name in rank found!
> 
> getIDs(db)
  [1] "1250"  "13651" "13652" "13654" "13655" "13657" "13658" "13659" "13661"
 [10] "13662" "13664" "13665" "13666" "13667" "13668" "13669" "13671" "13674"
 [19] "13677" "13678" "13679" "13680" "13681" "13682" "13683" "13685" "13687"
 [28] "13688" "13689" "13690" "13691" "13692" "13694" "13703" "13704" "13708"
 [37] "13717" "13721" "13728" "13730" "13755" "13757" "13758" "13759" "13760"
 [46] "13761" "13762" "13763" "13765" "13766" "13767" "13768" "13780" "13781"
 [55] "13789" "13790" "13792" "13793" "13797" "13799" "13800" "13803" "13806"
 [64] "13811" "13812" "13813" "13814" "13815" "13816" "13820" "13821" "13822"
 [73] "13823" "13824" "13825" "13826" "13827" "13834" "13836" "13837" "13838"
 [82] "13839" "13840" "13842" "13843" "13844" "13845" "13846" "13847" "13850"
 [91] "13851" "13852" "13853" "13855" "13856" "13857" "13858" "13860" "13861"
[100] "13862"
> ids <- getIDs(db, whereRank="genus", whereName="Desulfotomaculum")
> ids
 [1] "13651" "13652" "13654" "13655" "13657" "13658" "13659" "13661" "13664"
[10] "13665" "13667" "13668" "13669" "13671" "13677" "13678" "13679" "13680"
[19] "13681" "13682"
> 
> 
> getHierarchy(db, rank="genus", name="Syntrophomonas")
              Kingdom                Phylum                 Class 
           "Bacteria"          "Firmicutes"          "Clostridia" 
                Order                Family                 Genus 
      "Clostridiales" "Syntrophomonadaceae"      "Syntrophomonas" 
              Species                   Otu              Org_name 
                   NA                    NA                    NA 
                   Id 
                   NA 
> getHierarchy(db, rank="genus", name="S")
 [1] Kingdom  Phylum   Class    Order    Family   Genus    Species  Otu     
 [9] Org_name Id      
<0 rows> (or 0-length row.names)
Warning message:
In getRank(db, rank = rank, whereRank = rank, whereName = n) :
  No matching name in rank found!
> getHierarchy(db, rank="genus", name=c("Se", "Sy"))
 [1] Kingdom  Phylum   Class    Order    Family   Genus    Species  Otu     
 [9] Org_name Id      
<0 rows> (or 0-length row.names)
Warning messages:
1: In getRank(db, rank = rank, whereRank = rank, whereName = n) :
  No matching name in rank found!
2: In getRank(db, rank = rank, whereRank = rank, whereName = n) :
  No matching name in rank found!
> getHierarchy(db, rank="genus", name="doesnotexist!")
 [1] Kingdom  Phylum   Class    Order    Family   Genus    Species  Otu     
 [9] Org_name Id      
<0 rows> (or 0-length row.names)
Warning message:
In getRank(db, rank = rank, whereRank = rank, whereName = n) :
  No matching name in rank found!
> getHierarchy(db, rank="id", name="13655")
                                               Kingdom 
                                            "Bacteria" 
                                                Phylum 
                                          "Firmicutes" 
                                                 Class 
                                          "Clostridia" 
                                                 Order 
                                       "Clostridiales" 
                                                Family 
                                      "Peptococcaceae" 
                                                 Genus 
                                    "Desulfotomaculum" 
                                               Species 
                    "Desulfotomaculum thermobenzoicum" 
                                                   Otu 
                                            "otu_2150" 
                                              Org_name 
"Y11573.1Desulfotomaculumthermoacetoxidansstr.DSM5813" 
                                                    Id 
                                               "13655" 
> getHierarchy(db, rank="id", name=ids)
      Kingdom    Phylum       Class        Order           Family          
 [1,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
 [2,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
 [3,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
 [4,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
 [5,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
 [6,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
 [7,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
 [8,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
 [9,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[10,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[11,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[12,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[13,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[14,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[15,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[16,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[17,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[18,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[19,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
[20,] "Bacteria" "Firmicutes" "Clostridia" "Clostridiales" "Peptococcaceae"
      Genus              Species                            Otu       
 [1,] "Desulfotomaculum" "unknown"                          "otu_2143"
 [2,] "Desulfotomaculum" "Desulfotomaculum geothermicum"    "otu_2146"
 [3,] "Desulfotomaculum" "unknown"                          "otu_2143"
 [4,] "Desulfotomaculum" "Desulfotomaculum thermobenzoicum" "otu_2150"
 [5,] "Desulfotomaculum" "unknown"                          "otu_2143"
 [6,] "Desulfotomaculum" "unknown"                          "otu_2143"
 [7,] "Desulfotomaculum" "unknown"                          "otu_2143"
 [8,] "Desulfotomaculum" "Desulfotomaculum thermobenzoicum" "otu_2150"
 [9,] "Desulfotomaculum" "unknown"                          "otu_2143"
[10,] "Desulfotomaculum" "unknown"                          "otu_2143"
[11,] "Desulfotomaculum" "unknown"                          "otu_2143"
[12,] "Desulfotomaculum" "unknown"                          "otu_2143"
[13,] "Desulfotomaculum" "unknown"                          "otu_2143"
[14,] "Desulfotomaculum" "Desulfotomaculum thermobenzoicum" "otu_2150"
[15,] "Desulfotomaculum" "Desulfotomaculum thermobenzoicum" "otu_2150"
[16,] "Desulfotomaculum" "Desulfotomaculum acetoxidans"     "otu_2144"
[17,] "Desulfotomaculum" "Desulfotomaculum acetoxidans"     "otu_2144"
[18,] "Desulfotomaculum" "Desulfotomaculum acetoxidans"     "otu_2144"
[19,] "Desulfotomaculum" "unknown"                          "otu_2143"
[20,] "Desulfotomaculum" "Desulfotomaculum gibsoniae"       "otu_2147"
      Org_name                                                          
 [1,] "U33455.1Desulfotomaculumthermocisternumstr.ST90"                 
 [2,] "Y11567.1Desulfotomaculumgeothermicumstr.DSM3669"                 
 [3,] "AF069293.1Desulfotomaculumluciaestr.SLT"                         
 [4,] "Y11573.1Desulfotomaculumthermoacetoxidansstr.DSM5813"            
 [5,] "M96665.1Desulfotomaculumaustralicumstr.AB33"                     
 [6,] "U33456.1Desulfotomaculumsp.str.T93B"                             
 [7,] "U88891.1Desulfotomaculumhalophilumstr.SEBR3139"                  
 [8,] "L15628.1Desulfotomaculumthermobenzoicum"                         
 [9,] "Y11575.1Desulfotomaculumthermosapovoransstr.DSM6562"             
[10,] "AJ012599.1SulfatereducingfieldsoilandonricerootsDesulfotomaculum"
[11,] "Y14845.1Sporotomaculumhydroxybenzoicumstr.BTDSM5475"             
[12,] "Y11569.1Desulfotomaculumkuznetsoviistr.DSM6115"                  
[13,] "AF009646.1Desulfotomaculumkuznetsovii"                           
[14,] "Y11574.1Desulfotomaculumthermobenzoicumstr.DSM6193"              
[15,] "Y11578.1Desulfotomaculumsp.str.DSM7476"                          
[16,] "Y11566.1Desulfotomaculumacetoxidansstr.DSM771"                   
[17,] "AJ012600.1Desulfotomaculumsp.R-IbutA1"                           
[18,] "AJ012601.1Desulfotomaculumsp.R-AcA1"                             
[19,] "Z26315.1Desulfotomaculumthermosapovoransstr.MLF"                 
[20,] "Y11576.1Desulfotomaculumsp.str.DSM7213"                          
      Id     
 [1,] "13651"
 [2,] "13652"
 [3,] "13654"
 [4,] "13655"
 [5,] "13657"
 [6,] "13658"
 [7,] "13659"
 [8,] "13661"
 [9,] "13664"
[10,] "13665"
[11,] "13667"
[12,] "13668"
[13,] "13669"
[14,] "13671"
[15,] "13677"
[16,] "13678"
[17,] "13679"
[18,] "13680"
[19,] "13681"
[20,] "13682"
> 
> #getHierarchy(db)
> 
> closeGenDB(db)
> 
> 
